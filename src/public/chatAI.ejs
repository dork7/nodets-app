<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ChatAI Window</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f4f4f4; }
        #chat-container { width: 400px; margin: 40px auto; background: #fff; border-radius: 8px; box-shadow: 0 2px 8px #ccc; padding: 20px; }
        #messages { height: 300px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; margin-bottom: 10px; background: #fafafa; }
        .message { margin-bottom: 8px; }
        .user { color: #007bff; }
        .ai { color: #28a745; }
        #input-form { display: flex; }
        #input { flex: 1; padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
        #send { padding: 8px 16px; border: none; background: #007bff; color: #fff; border-radius: 4px; cursor: pointer; }
        #send:hover { background: #0056b3; }
    </style>
</head>
<body>
    <div id="chat-container">
        <div id="messages"></div>
        <form id="input-form">
            <input id="input" autocomplete="off" placeholder="Type your message..." />
            <button id="send" type="submit">Send</button>
        </form>
    </div>
    <script nonce="abc123">
        // Replace with your server's WebSocket endpoint
        const socket = new WebSocket('ws://localhost:2020/ws/chatAI');

        const messages = document.getElementById('messages');
        const form = document.getElementById('input-form');
        const input = document.getElementById('input');

        socket.addEventListener('open', function () {
            appendMessage('System', 'Connected to chat server.', 'system');
        });

        socket.addEventListener('message', function (event) {
            console.log('Message from server ', event.data);
            const data = JSON.parse(event.data);
            appendMessage(data.sender, data.content, data.sender === 'AI' ? 'ai' : 'user');
        });

        socket.addEventListener('close', function () {
            appendMessage('System', 'Disconnected from chat server.', 'system');
        });

        form.addEventListener('submit', function (e) {
            e.preventDefault();
            const msg = input.value.trim();
            if (msg) {
                socket.send(JSON.stringify({ sender: 'User',   "type": "request",
                    "id": "1234",
                    "method": "chatAI",
                    "params": { "prompt": msg }}));
                appendMessage('You', msg, 'user');
                input.value = '';
            }
        });

        function appendMessage(sender, message, type) {
            const div = document.createElement('div');
            div.className = 'message ' + type;
            div.innerHTML = `<strong>${sender}:</strong> ${message}`;
            messages.appendChild(div);
            messages.scrollTop = messages.scrollHeight;
        }
    </script>
</body>
</html>